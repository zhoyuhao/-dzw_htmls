<!DOCTYPE html>
<html class="x-admin-sm">
    
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="../css/bootstrap.min.css" />
        <title>欢迎页面-X-admin2.2</title>
        <link rel="stylesheet" href="../css/index.css" />
		<script type="text/javascript" src="../js/vue.js"></script>
		<script type="text/javascript" src="../js/jquery-1.12.4.js"></script>
		<script type="text/javascript" src="../js/jq_ajax_config.js"></script>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="../css/font.css">
        <link rel="stylesheet" href="../css/xadmin.css">
        <script src="../lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="../js/xadmin.js"></script>
    </head>
    
    <body>
        <div class="x-nav">
            <span class="layui-breadcrumb">
                <a href="">首页</a>
                <a href="">演示</a>
                <a>
                    <cite>导航元素</cite></a>
            </span>
            <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" onclick="location.reload()" title="刷新">
                <i class="layui-icon layui-icon-refresh" style="line-height:30px"></i>
            </a>
        </div>
            <div class="layui-row layui-col-space15" id="carApp">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-body " style="text-align: center;">
                                <div class="layui-input-inline layui-show-xs-block">
                                    <input type="text" v-model="carlicenceplate" placeholder="请输入车牌" autocomplete="off" class="layui-input"></div>
                                <div class="layui-input-inline layui-show-xs-block">
                                    <button class="layui-btn" @click="query(1,carlicenceplate)">
                                        <i class="layui-icon">&#xe615;</i></button>
                                </div>
                        </div>
                        <div class="layui-card-header">
                            <button class="layui-btn" onclick="xadmin.open('添加用户','车辆信息添加.html',800,600)">
                                <i class="layui-icon"></i>添加</button></div>
                      	<template>
							<el-table :data="this.page.list" style="width: 100%">
								<el-table-column label="车辆车牌" prop="carlicenceplate">
								</el-table-column>
								<el-table-column label="车辆品牌" prop="carbrand">
								</el-table-column>
								<el-table-column label="车辆颜色" prop="carcolor">
								</el-table-column>
								<el-table-column label="车辆配置" prop="carconfigure">
								</el-table-column>
								<el-table-column label="车辆产地" prop="carlocality">
								</el-table-column>
								<el-table-column label="车辆款式" prop="carmodel">
								</el-table-column>
								<el-table-column label="操作">
									<template slot-scope="temp">
										<el-button icon="el-icon-edit" size="mini" type="primary" @click="showView(temp.row.carid)">编辑</el-button>
										<el-button icon="el-icon-delete" size="mini" type="danger" @click="delInfo(temp.row.carid)">删除</el-button>
									</template>
								</el-table-column>
							</el-table>
						</template>
						<div style="text-align:right;padding-right: 200px;">
							<el-button size="mini" @click="handleCurrentChange(1)">第一页</el-button>
							<el-button size="mini" v-if="page.hasPreviousPage" @click="handleCurrentChange(page.prePage)">上一页</el-button>
							<el-button size="mini" v-if="page.hasNextPage" @click="handleCurrentChange(page.nextPage)">下一页</el-button>
							<el-button size="mini" @click="handleCurrentChange(page.pages)">最后页</el-button>
							<span>第{{page.pageNum}}页/共{{page.pages}}页</span>
						</div>
						
                    </div>
                </div>
            </div>
    </body>
    <script type="text/javascript" src="../js/index.js"></script>
	<script type="text/javascript" src="../js/bootstrap.min.js"></script>
    <script>
    	var carApp = new Vue({
			el: '#carApp',
			data: {
				page: [],
				carlicenceplate:"",
			},
			methods:{
				//分页查询车辆信息
				query(pageNum,carlicenceplate){
					if(carlicenceplate==""){
						carlicenceplate=null;
					}
					let _this = this;
					$.getJSON(`http://localhost:8080/ljn/api/ljnCustomercarAction/query/${pageNum}/${carlicenceplate}`, function(res) {
						_this.page = res;
					});
				},
				//删除车辆信息
				delInfo(carid){
					let _this = this;
					if(confirm("是否删除")){
						$.getJSON(`http://localhost:8080/ljn/api/ljnCustomercarAction/remove/${carid}`, function(res) {
						if(res>0){
							alert("删除成功")
							_this.query(1, "null");
						}
					});
					}
				},
				//翻页
				handleCurrentChange(pageNum){
					let _this = this;
					_this.query(pageNum,"null");
				},
				//查询指定车辆信息
				showView(carid){
					let _this = this;
					$.getJSON(`http://localhost:8080/ljn/api/ljnCustomercarAction/queryid/${carid}`, function(res) {
					window.sessionStorage.setItem('car', JSON.stringify(res));
					xadmin.open('修改车辆','车辆信息修改.html',800,600);
				})
				},
			},
			mounted() {
				let _this = this;
				_this.query(1, "");
			},
    	})
    	
    </script>

</html>