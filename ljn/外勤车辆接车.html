<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title></title>
		<link href="../css/style.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="../css/index.css" />
	</head>

	<body>
		<div id="addApp" style="width: 80%;margin: 0 auto;">
			<h2 style="text-align: center;">外勤借车管理</h2>
			<el-form style="width: 70%;margin: 0 auto;" :inline="true" label-position="left" label-width="100px" :model="bill" style="text-align: center;">
			<el-form-item label="车牌号">
		    <el-select v-model="bill.wcarid" placeholder="请选择">
		      <el-option v-for="item in bill" :label="item.wcarid" :value="item.wcarid" ></el-option>
		    </el-select>
		  </el-form-item>
				<el-form-item label="驾驶员:">
					<el-input v-model="bill.title"></el-input>
				</el-form-item>
				<el-form-item label="备注：">
					<el-input v-model="bill.summary"></el-input>
				</el-form-item>
			</el-form>
			<div style="text-align: right;">
				<el-button @click="addBill">保存</el-button>
				<el-button @click="gotoHt">取消</el-button>
			</div>
		</div>

		<script type="text/javascript" src="../js/jquery-1.12.4.js"></script>
		<script type="text/javascript" src="../js/vue.js"></script>
		<script type="text/javascript" src="../js/index.js"></script>
		<script type="text/javascript" src="../js/jq_ajax_config.js"></script>
		<script>
			var myDate = new Date();
			var app = new Vue({
				data: {
					bill: {
						wId: '',
						wcarid: '',
					},
					jie:JSON.parse(window.sessionStorage.getItem("jie")),
					name:'',
					activeName: 'first'
				},
				
				methods:{
					//查询接车信息
					query(){
					let _this = this;
					$.getJSON(`http://localhost:8080/ljn/api/ljnServiceAction/query`, function(res) {
						_this.bill = res;
					});
					},
					//用户接车
					addBill(){
						let _this = this;
						_this.jie.state="已出车";
					$.ajax({
							type: "POST",
							contentType: "application/json",
							data: JSON.stringify(_this.jie),
							url: `http://127.0.0.1:8080/ljn/api/ljnlegworkAction/update`,
							success: function(res) {
								if(res != 0) {
									alert("接车成功");
									xadmin.close();
									legworkApp.query(1, "未出车");
								}
							}
						});
					}
				},
				
			mounted() {
				let _this = this;
				_this.query(1,"未出车");
			},

			}).$mount("#addApp");
		</script>
	</body>

</html>